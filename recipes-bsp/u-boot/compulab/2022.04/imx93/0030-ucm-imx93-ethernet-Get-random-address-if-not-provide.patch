From 2597ef014081ab29f930adc7153bda1fdd1476bb Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Tue, 6 Jun 2023 12:19:49 +0300
Subject: [PATCH] ucm-imx93: ethernet: Get random address if not provided by
 eeprom

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 board/compulab/ucm-imx93/ucm-imx93.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/board/compulab/ucm-imx93/ucm-imx93.c b/board/compulab/ucm-imx93/ucm-imx93.c
index ceb6eda38c..038aa74d1f 100644
--- a/board/compulab/ucm-imx93/ucm-imx93.c
+++ b/board/compulab/ucm-imx93/ucm-imx93.c
@@ -132,6 +132,10 @@ static void board_gpio_init(void)
 static void board_get_mac_from_eeprom(int dev_id) {
 	unsigned char mac[6];
 	cl_eeprom_read_n_mac_addr(mac, dev_id, CONFIG_SYS_I2C_EEPROM_BUS);
+
+	if (is_zero_ethaddr(mac) || !is_valid_ethaddr(mac))
+		net_random_ethaddr(mac);
+
 	eth_env_set_enetaddr_by_index("eth",dev_id,mac);
 	return;
 }
-- 
2.17.1

